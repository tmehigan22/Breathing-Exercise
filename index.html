<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>4-7-8 Breathing</title>
  <style>
    :root{
      --bg: #2f2f2f;
      --ringTrack: rgba(255,255,255,0.18);

      --segInhale: #4f7f67;
      --segHold:   #9bbfae;
      --segExhale: #e6e3d6;

      --text: rgba(255,255,255,0.85);
      --muted: rgba(255,255,255,0.55);

      --size: min(72vw, 320px);
      --stroke: 14;
      --dot: 16px;
      --dotFill: #d8a3a3;
      --dotOutline: rgba(0,0,0,0.35);

      --minScale: 0.78;
      --maxScale: 1.14;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px;
    }

    .wrap{
      width: min(680px, 100%);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 14px;
    }

    /* NEW TITLE */
    .calmTitle{
      margin: 0 0 4px 0;
      font-size: 17px;
      font-weight: 500;
      letter-spacing: 0.3px;
      color: rgba(255,255,255,0.75);
      text-align: center;
      line-height: 1.4;
    }

    .vizBox{
      position: relative;
      width: var(--size);
      height: var(--size);
      display:grid;
      place-items:center;
      user-select:none;
    }

    .ringScale{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      transform: scale(var(--minScale));
      transition: transform 120ms linear;
      will-change: transform;
    }

    svg{
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
    }

    .centerText{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      text-transform: lowercase;
      font-size: 28px;
      letter-spacing: 0.5px;
    }

    .dot{
      position:absolute;
      width: var(--dot);
      height: var(--dot);
      border-radius: 999px;
      background: var(--dotFill);
      border: 2px solid var(--dotOutline);
      transform: translate3d(0,0,0);
      will-change: transform;
      pointer-events:none;
    }

    .controls{
      display:flex;
      gap: 10px;
    }

    button{
      appearance:none;
      border: 1px solid rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.08);
      color: var(--text);
      padding: 10px 16px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 650;
    }

    button.primary{
      background: rgba(255,255,255,0.92);
      color: rgba(0,0,0,0.82);
    }

    button:disabled{
      opacity: 0.55;
      cursor:not-allowed;
    }

    .hint{
      color: var(--muted);
      font-size: 13px;
      text-align:center;
      margin: 0;
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- TITLE ADDED -->
    <h2 class="calmTitle">It will be okay, stay as long as you need</h2>

    <div class="vizBox" id="vizBox">
      <div class="ringScale" id="ringScale">
        <svg viewBox="0 0 200 200">
          <circle cx="100" cy="100" r="70"
                  fill="none" stroke="var(--ringTrack)"
                  stroke-width="var(--stroke)" />

          <circle id="segInhale" cx="100" cy="100" r="70"
                  fill="none" stroke="var(--segInhale)"
                  stroke-width="var(--stroke)" />
          <circle id="segHold" cx="100" cy="100" r="70"
                  fill="none" stroke="var(--segHold)"
                  stroke-width="var(--stroke)" />
          <circle id="segExhale" cx="100" cy="100" r="70"
                  fill="none" stroke="var(--segExhale)"
                  stroke-width="var(--stroke)" />
        </svg>
      </div>

      <div class="centerText" id="phaseLabel">inhale</div>
      <div class="dot" id="dot"></div>
    </div>

    <div class="controls">
      <button class="primary" id="startBtn">Start</button>
      <button id="pauseBtn" disabled>Pause</button>
    </div>

    <p class="hint">Inhale 4 seconds • Hold 7 seconds • Exhale 8 seconds</p>
  </div>

<script>
  const phases = [
    { key:"inhale", sec:4 },
    { key:"hold", sec:7 },
    { key:"exhale", sec:8 }
  ];
  const totalSec = 19;

  const vizBox = document.getElementById("vizBox");
  const ringScale = document.getElementById("ringScale");
  const phaseLabel = document.getElementById("phaseLabel");
  const dot = document.getElementById("dot");
  const startBtn = document.getElementById("startBtn");
  const pauseBtn = document.getElementById("pauseBtn");

  const svgR = 70;
  let geom = { cx:0, cy:0, r:0 };

  function recompute(){
    const b = vizBox.getBoundingClientRect();
    geom.cx = b.width/2;
    geom.cy = b.height/2;
    geom.r = (Math.min(b.width,b.height)/2)*(svgR/100);
  }
  window.addEventListener("resize", recompute);

  let running=false, paused=false, raf;
  let t0=0, pausedAt=0, pauseAccum=0;

  function now(){ return performance.now(); }

  function elapsed(){
    return ((now()-t0-pauseAccum)/1000)%totalSec;
  }

  function lerp(a,b,t){ return a+(b-a)*t; }

  function phaseFor(sec){
    let a=0;
    for(const p of phases){
      if(sec>=a && sec<a+p.sec)
        return {p, t:(sec-a)/p.sec};
      a+=p.sec;
    }
    return {p:phases[2], t:1};
  }

  function tick(){
    if(!running||paused) return;
    const sec=elapsed();
    const frac=sec/totalSec;
    const {p,t}=phaseFor(sec);

    phaseLabel.textContent=p.key;

    let scale=0.78;
    if(p.key==="inhale") scale=lerp(0.78,1.14,t);
    if(p.key==="hold") scale=1.14;
    if(p.key==="exhale") scale=lerp(1.14,0.78,t);
    ringScale.style.transform=`scale(${scale})`;

    const ang=-Math.PI/2+frac*2*Math.PI;
    const x=geom.cx+geom.r*scale*Math.cos(ang);
    const y=geom.cy+geom.r*scale*Math.sin(ang);
    dot.style.transform=`translate3d(${x-8}px,${y-8}px,0)`;

    raf=requestAnimationFrame(tick);
  }

  startBtn.onclick=()=>{
    if(running) return;
    running=true;
    paused=false;
    pauseAccum=0;
    t0=now();
    startBtn.disabled=true;
    pauseBtn.disabled=false;
    pauseBtn.textContent="Pause";
    raf=requestAnimationFrame(tick);
  };

  pauseBtn.onclick=()=>{
    if(!running) return;
    if(!paused){
      paused=true;
      pausedAt=now();
      pauseBtn.textContent="Resume";
      cancelAnimationFrame(raf);
    }else{
      paused=false;
      pauseAccum+=now()-pausedAt;
      pauseBtn.textContent="Pause";
      raf=requestAnimationFrame(tick);
    }
  };

  recompute();
  tick();
</script>
</body>
</html>
